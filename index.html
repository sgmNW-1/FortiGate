<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FortiGate Delivery Master v7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; }
        .tab-active { border-bottom: 3px solid #dc2626; color: #dc2626; }
        .system-tag { display: inline-flex; align-items: center; background: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 4px; margin: 2px; font-size: 0.75rem; border: 1px solid #fecaca; }
        tr:hover .action-btns { opacity: 1; }
        .action-btns { opacity: 0.3; transition: opacity 0.2s; }
        .sync-active { background-color: #059669 !important; border-color: #047857 !important; }
        .news-card { border-left: 4px solid #dc2626; background: #fff1f2; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-10">

    <nav class="bg-slate-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3 cursor-pointer" onclick="location.reload()">
                <div class="bg-red-600 p-2 rounded-lg"><i class="fas fa-server text-white text-xl"></i></div>
                <span class="text-xl font-bold tracking-tighter">FG Delivery <span class="text-red-500">Master</span></span>
            </div>
            <div class="flex items-center space-x-4">
                <div id="sync-status" class="text-[10px] px-2 py-1 rounded bg-slate-800 text-slate-400 border border-slate-700">
                    <i class="fas fa-database mr-1"></i>NASæœªæ¥ç¶š
                </div>
                <button id="btn-sync-load" onclick="syncWithNAS()" class="bg-slate-700 hover:bg-slate-600 text-white px-3 py-1.5 rounded text-sm border border-slate-600 shadow-sm transition-all"><i class="fas fa-link mr-1 text-yellow-400"></i>NASåŒæœŸ</button>
                <button id="btn-save" onclick="saveToNAS()" class="bg-slate-700 hover:bg-slate-600 text-white px-3 py-1.5 rounded text-sm border border-slate-600 shadow-sm transition-all"><i class="fas fa-save mr-1 text-blue-400"></i>ä¿å­˜</button>
                <button onclick="enterSettings()" class="text-slate-300 hover:text-white hover:rotate-90 transition-all duration-300 ml-2"><i class="fas fa-cog text-xl"></i></button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        <div class="flex space-x-8 mb-6 border-b border-gray-200">
            <button onclick="switchTab('list')" id="tab-list" class="pb-4 font-bold transition-all tab-active"><i class="fas fa-list mr-2"></i>ç´å“ä¸€è¦§</button>
            <button onclick="switchTab('register')" id="tab-register" class="pb-4 font-bold text-gray-500 hover:text-red-600 transition-all"><i class="fas fa-plus-square mr-2"></i><span id="reg-tab-label">æ–°è¦ç™»éŒ²</span></button>
            <button onclick="switchTab('news')" id="tab-news" class="pb-4 font-bold text-gray-500 hover:text-orange-600 transition-all"><i class="fas fa-bullhorn mr-2"></i>æœ€æ–°æƒ…å ±</button>
            <button onclick="switchTab('settings')" id="tab-settings" class="hidden pb-4 font-bold text-gray-500 hover:text-blue-600 transition-all"><i class="fas fa-wrench mr-2"></i>ç®¡ç†è€…è¨­å®š</button>
        </div>

        <div id="content-news" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2">
                    <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>é‡è¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒª
                    </h3>
                    <div class="news-card border-red-600 shadow-sm">
                        <div class="flex justify-between items-start mb-2">
                            <span class="bg-red-600 text-white text-[10px] px-2 py-1 rounded font-bold uppercase tracking-widest">Critical</span>
                            <span class="text-xs text-gray-500">2026/01/27</span>
                        </div>
                        <h4 class="font-bold text-slate-800 mb-2 underline">CVE-2026-24858: FortiCloud SSO èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ã®è„†å¼±æ€§</h4>
                        <p class="text-sm text-slate-600 mb-3">æ”»æ’ƒè€…ãŒFortiCloudã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµŒç”±ã§ä»–è€…ã®ãƒ‡ãƒã‚¤ã‚¹ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹é‡å¤§ãªè„†å¼±æ€§ã§ã™ã€‚é‡ç”Ÿã§ã®æ‚ªç”¨ãŒç¢ºèªã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
                        <div class="text-xs font-mono bg-white p-2 rounded border border-red-100">æ¨å¥¨å¯¾ç­–: FortiOS 7.6.5 / 7.4.10 ä»¥ä¸Šã¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ</div>
                    </div>

                    <div class="news-card border-orange-500 bg-orange-50">
                        <div class="flex justify-between items-start mb-2">
                            <span class="bg-orange-500 text-white text-[10px] px-2 py-1 rounded font-bold uppercase tracking-widest">High</span>
                            <span class="text-xs text-gray-500">2026/02/10</span>
                        </div>
                        <h4 class="font-bold text-slate-800 mb-2">FG-IR-25-1052: FSSOã«ãŠã‘ã‚‹èªè¨¼ãƒã‚¤ãƒ‘ã‚¹</h4>
                        <p class="text-sm text-slate-600">SSL-VPNç’°å¢ƒç­‰ã§ä½¿ç”¨ã•ã‚Œã‚‹FSSOã«ãŠã„ã¦ã€èªè¨¼ãŒå›é¿ã•ã‚Œã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚æœ€æ–°ã®ãƒ‘ãƒƒãƒé©ç”¨ãŒå¿…è¦ã§ã™ã€‚</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2 italic">Recommended Firmware</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm"><span class="font-bold text-slate-500">v7.6 (Latest)</span> <span class="font-mono bg-green-100 px-2 rounded">7.6.5</span></div>
                            <div class="flex justify-between text-sm"><span class="font-bold text-slate-500">v7.4 (Stable)</span> <span class="font-mono bg-green-100 px-2 rounded">7.4.10</span></div>
                            <div class="flex justify-between text-sm"><span class="font-bold text-slate-500">v7.2 (Legacy)</span> <span class="font-mono bg-yellow-100 px-2 rounded">7.2.13</span></div>
                            <div class="flex justify-between text-sm"><span class="font-bold text-slate-500">v7.0 (LTS)</span> <span class="font-mono bg-yellow-100 px-2 rounded">7.0.18</span></div>
                        </div>
                        <p class="text-[10px] text-gray-400 mt-4 leading-relaxed">â€»2026å¹´2æœˆ20æ—¥æ™‚ç‚¹ã®æƒ…å ±ã§ã™ã€‚æœ€æ–°ã®æ­£å¼ç‰ˆã¯å…¬å¼ãƒãƒ¼ã‚¿ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
                    </div>

                    <div class="bg-slate-800 p-6 rounded-xl shadow-sm text-white">
                        <h3 class="font-bold mb-4 flex items-center"><i class="fas fa-external-link-alt mr-2 text-blue-400"></i>å…¬å¼ãƒªãƒ³ã‚¯</h3>
                        <div class="space-y-3">
                            <a href="https://www.fortiguard.com/psirt" target="_blank" class="block text-sm bg-slate-700 hover:bg-slate-600 p-2 rounded transition-colors border border-slate-600">FortiGuard PSIRT (è„†å¼±æ€§)</a>
                            <a href="https://support.fortinet.com" target="_blank" class="block text-sm bg-slate-700 hover:bg-slate-600 p-2 rounded transition-colors border border-slate-600">Support Portal (FWå…¥æ‰‹)</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="content-list" class="block">
            <div class="mb-6 flex gap-4">
                <div class="relative w-full md:w-1/2 lg:w-1/3">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400"><i class="fas fa-search"></i></span>
                    <input type="text" id="search-input" onkeyup="renderTable()" class="w-full border border-gray-300 rounded-lg py-2.5 pl-10 pr-4 shadow-sm outline-none" placeholder="æ¤œç´¢...">
                </div>
            </div>
            <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden overflow-x-auto">
                <table class="w-full text-left min-w-[1000px]">
                    <thead>
                        <tr class="bg-slate-50 border-b text-slate-600 text-xs font-bold uppercase tracking-wider">
                            <th class="px-6 py-4">ç´å“å…ˆ / åœ°åŸŸ</th><th class="px-6 py-4">å‹ç•ª / S/N</th><th class="px-6 py-4">ç®¡ç†IP</th><th class="px-6 py-4">FWæƒ…å ±</th><th class="px-6 py-4">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</th><th class="px-6 py-4">ã‚·ã‚¹ãƒ†ãƒ </th><th class="px-6 py-4 text-center">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="inventory-tbody" class="divide-y divide-gray-100"></tbody>
                </table>
            </div>
        </div>

        <div id="content-register" class="hidden">
            <div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-md border border-gray-100">
                <h2 id="form-title" class="text-2xl font-bold text-slate-800 mb-6 border-l-4 border-red-600 pl-4">æ©Ÿå™¨æƒ…å ±ã®ç™»éŒ²</h2>
                <input type="hidden" id="edit-index" value="-1">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">ç´å“å…ˆ</label><input type="text" id="reg-customer" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">åœ°åŸŸ</label><input type="text" id="reg-region" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">å‹ç•ª</label><input list="model-options" id="reg-model" class="w-full border p-2.5 rounded-lg"><datalist id="model-options"></datalist></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">ã‚·ãƒªã‚¢ãƒ«</label><input type="text" id="reg-serial" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">ç®¡ç†IP</label><input type="text" id="reg-ip" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">FW Ver</label><input type="text" id="reg-fw-ver" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">FWæ›´æ–°æ—¥</label><input type="date" id="reg-fw-date" class="w-full border p-2.5 rounded-lg"></div>
                    <div><label class="block text-sm font-bold text-gray-700 mb-2">PW</label><input type="text" id="reg-pw" class="w-full border p-2.5 rounded-lg"></div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold text-gray-700 mb-2">ã‚·ã‚¹ãƒ†ãƒ </label>
                        <div class="flex gap-2"><select id="reg-sys-select" class="flex-1 border p-2.5 rounded-lg"></select><button onclick="addSystemTag()" class="bg-slate-800 text-white px-4 py-2 rounded-lg">è¿½åŠ </button></div>
                        <div id="selected-systems" class="flex flex-wrap p-3 bg-gray-50 rounded-lg border mt-2 min-h-[50px]"></div>
                    </div>
                </div>
                <div class="mt-8 flex justify-end space-x-4">
                    <button id="cancel-edit-btn" onclick="cancelEdit()" class="hidden bg-gray-200 px-6 py-3 rounded-xl font-bold">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button onclick="saveData()" class="bg-red-600 text-white px-10 py-3 rounded-xl font-bold shadow-lg"><i class="fas fa-save mr-2"></i><span id="save-btn-label">ç™»éŒ²ã™ã‚‹</span></button>
                </div>
            </div>
        </div>

        <div id="content-settings" class="hidden">
            <div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-md border border-gray-100">
                <h2 class="text-2xl font-bold text-slate-800 mb-6 border-l-4 border-blue-600 pl-4">ç®¡ç†è€…è¨­å®š</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-6 rounded-xl">
                        <h3 class="font-bold mb-4">ã‚·ã‚¹ãƒ†ãƒ ä¸€è¦§</h3>
                        <div class="flex gap-2 mb-4"><input type="text" id="new-master-sys" class="flex-1 border p-2" placeholder="åå‰"><button onclick="addMasterSetting('system')" class="bg-blue-600 text-white px-4 py-2 rounded">è¿½åŠ </button></div>
                        <div id="settings-sys-list"></div>
                    </div>
                    <div class="bg-slate-50 p-6 rounded-xl">
                        <h3 class="font-bold mb-4">å‹ç•ªä¸€è¦§</h3>
                        <div class="flex gap-2 mb-4"><input type="text" id="new-master-model" class="flex-1 border p-2" placeholder="FG-XXX"><button onclick="addMasterSetting('model')" class="bg-blue-600 text-white px-4 py-2 rounded">è¿½åŠ </button></div>
                        <div id="settings-model-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ADMIN_PW = "komayuu28";      // âš™ï¸ç®¡ç†è€…
        const VIEW_PW = "sigma-sol2012";   // ğŸ‘ï¸ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é–²è¦§
        const LOCAL_STORAGE_KEY = "fortigate_master_v7";

        let masterSystems = ["æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ éƒ¨", "å–¶æ¥­éƒ¨", "çµŒç†ãƒ»ç·å‹™", "åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ ", "ç›£è¦–ã‚«ãƒ¡ãƒ©"];
        let masterModels = ["FG-40F", "FG-60F", "FG-80F", "FG-100F", "FG-200F"];
        let inventoryData = [];
        let selectedSystems = [];
        let fileHandle = null;

        async function syncWithNAS() {
            try {
                [fileHandle] = await window.showOpenFilePicker({ types: [{ description: 'JSON', accept: { 'application/json': ['.json'] } }] });
                const content = await (await fileHandle.getFile()).text();
                const parsed = JSON.parse(content);
                inventoryData = parsed.inventoryData || [];
                masterSystems = parsed.masterSystems || masterSystems;
                masterModels = parsed.masterModels || masterModels;
                updateSyncUI((await fileHandle.getFile()).name);
                saveToLocal(); updateDynamicLists(); renderTable();
                alert("NASåŒæœŸå®Œäº†ï¼");
            } catch (err) { if(err.name !== 'AbortError') alert("æ¥ç¶šå¤±æ•—: " + err); }
        }

        async function saveToNAS() {
            const data = JSON.stringify({ inventoryData, masterSystems, masterModels }, null, 2);
            if (fileHandle) {
                const writable = await fileHandle.createWritable();
                await writable.write(data);
                await writable.close();
                alert("NASã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥æ›´æ–°ã—ã¾ã—ãŸã€‚");
            } else {
                const a = document.createElement('a');
                a.href = URL.createObjectURL(new Blob([data], { type: 'application/json' }));
                a.download = `FG_Data_${new Date().toISOString().split('T')[0]}.json`; a.click();
                alert("NASæœªæ¥ç¶šã®ãŸã‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¿å­˜ã—ã¾ã—ãŸã€‚");
            }
        }

        function updateSyncUI(name) {
            const st = document.getElementById('sync-status');
            st.innerHTML = `<i class="fas fa-database mr-1 text-green-400"></i>åŒæœŸä¸­: ${name}`;
            document.getElementById('btn-sync-load').classList.add('sync-active');
        }

        function renderTable() {
            const term = document.getElementById('search-input').value.toLowerCase();
            const tbody = document.getElementById('inventory-tbody');
            const filtered = inventoryData.map((item, index) => ({item, index})).filter(o => 
                o.item.customer.toLowerCase().includes(term) || o.item.model.toLowerCase().includes(term)
            );
            if (!filtered.length) { tbody.innerHTML = `<tr><td colspan="7" class="text-center py-10 text-gray-400">ãªã—</td></tr>`; return; }
            tbody.innerHTML = filtered.map(o => `
                <tr class="hover:bg-slate-50 transition-colors group">
                    <td class="px-6 py-4"><div class="font-bold text-slate-800">${o.item.customer}</div><div class="text-[10px] text-slate-400">${o.item.region}</div></td>
                    <td class="px-6 py-4"><div class="font-mono text-sm font-bold text-blue-700">${o.item.model}</div><div class="text-[10px] text-gray-500">S/N: ${o.item.serial}</div></td>
                    <td class="px-6 py-4 text-xs font-mono">${o.item.ip || '-'}</td>
                    <td class="px-6 py-4"><div class="text-sm font-bold text-green-600">${o.item.fw_version}</div><div class="text-[10px] text-gray-400">${o.item.fw_updated_at}</div></td>
                    <td class="px-6 py-4"><button onclick="showPassword(${o.index})" class="text-[10px] bg-white border py-1 px-3 rounded-full">è¡¨ç¤º</button></td>
                    <td class="px-6 py-4"><div class="flex flex-wrap">${o.item.systems.map(s => `<span class="system-tag">${s}</span>`).join('')}</div></td>
                    <td class="px-6 py-4 text-center">
                        <div class="action-btns flex justify-center space-x-2">
                            <button onclick="editData(${o.index})" class="p-2 text-blue-600 hover:bg-blue-50 rounded"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteData(${o.index})" class="p-2 text-red-600 hover:bg-red-50 rounded"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>`).join('');
        }

        function switchTab(t) {
            ['list', 'register', 'news', 'settings'].forEach(k => {
                document.getElementById(`content-${k}`).classList.add('hidden');
                document.getElementById(`tab-${k}`).classList.remove('tab-active');
            });
            document.getElementById(`content-${t}`).classList.remove('hidden');
            document.getElementById(`tab-${t}`).classList.add('tab-active');
            if (t === 'list') renderTable();
            if (t === 'register') updateDynamicLists();
        }

        function saveData() {
            const idx = parseInt(document.getElementById('edit-index').value);
            const item = {
                customer: document.getElementById('reg-customer').value,
                region: document.getElementById('reg-region').value,
                model: document.getElementById('reg-model').value,
                serial: document.getElementById('reg-serial').value,
                ip: document.getElementById('reg-ip').value,
                fw_version: document.getElementById('reg-fw-ver').value,
                fw_updated_at: document.getElementById('reg-fw-date').value,
                pw: document.getElementById('reg-pw').value,
                systems: [...selectedSystems]
            };
            if(!item.customer) return alert("ç´å“å…ˆå¿…é ˆ");
            if(idx === -1) inventoryData.push(item); else inventoryData[idx] = item;
            saveToLocal(); clearForm(); if(idx !== -1) cancelEdit(); switchTab('list');
        }

        function editData(idx) {
            const item = inventoryData[idx];
            document.getElementById('edit-index').value = idx;
            document.getElementById('reg-customer').value = item.customer;
            document.getElementById('reg-region').value = item.region;
            document.getElementById('reg-model').value = item.model;
            document.getElementById('reg-serial').value = item.serial;
            document.getElementById('reg-ip').value = item.ip;
            document.getElementById('reg-fw-ver').value = item.fw_version;
            document.getElementById('reg-fw-date').value = item.fw_updated_at;
            document.getElementById('reg-pw').value = item.pw;
            selectedSystems = [...item.systems]; updateSystemTags();
            document.getElementById('form-title').innerText = "æƒ…å ±ã®ç·¨é›†";
            document.getElementById('save-btn-label').innerText = "æ›´æ–°ä¿å­˜";
            document.getElementById('reg-tab-label').innerText = "ç·¨é›†ãƒ¢ãƒ¼ãƒ‰";
            document.getElementById('cancel-edit-btn').classList.remove('hidden');
            switchTab('register');
        }

        function deleteData(idx) { if(confirm("å‰Šé™¤ï¼Ÿ")) { inventoryData.splice(idx, 1); saveToLocal(); renderTable(); } }
        function cancelEdit() { document.getElementById('edit-index').value = "-1"; document.getElementById('cancel-edit-btn').classList.add('hidden'); clearForm(); switchTab('list'); }
        function showPassword(idx) { if (prompt("é–²è¦§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›") === VIEW_PW) alert("PW: " + inventoryData[idx].pw); }
        function enterSettings() { if (prompt("ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›") === ADMIN_PW) { document.getElementById('tab-settings').classList.remove('hidden'); switchTab('settings'); renderSettingsLists(); } }
        function saveToLocal() { localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({ inventoryData, masterSystems, masterModels })); }
        function loadFromLocal() { const s = localStorage.getItem(LOCAL_STORAGE_KEY); if(s){ const p = JSON.parse(s); inventoryData = p.inventoryData; masterSystems = p.masterSystems; masterModels = p.masterModels; } }
        function updateDynamicLists() {
            document.getElementById('reg-sys-select').innerHTML = '<option value="">é¸æŠ</option>' + masterSystems.map(s => `<option value="${s}">${s}</option>`).join('');
            document.getElementById('model-options').innerHTML = masterModels.map(m => `<option value="${m}">`).join('');
        }
        function addSystemTag() { const v = document.getElementById('reg-sys-select').value; if (v && !selectedSystems.includes(v)) { selectedSystems.push(v); updateSystemTags(); } }
        function updateSystemTags() { document.getElementById('selected-systems').innerHTML = selectedSystems.map(s => `<span class="system-tag">${s} <i class="fas fa-times ml-2 cursor-pointer" onclick="selectedSystems=selectedSystems.filter(x=>x!=='${s}');updateSystemTags()"></i></span>`).join(''); }
        function clearForm() { ['reg-customer','reg-region','reg-model','reg-serial','reg-ip','reg-fw-ver','reg-fw-date','reg-pw'].forEach(id => document.getElementById(id).value = ""); selectedSystems = []; updateSystemTags(); }
        function renderSettingsLists() {
            document.getElementById('settings-sys-list').innerHTML = masterSystems.map(s => `<div class="flex justify-between bg-white p-2 mb-1 rounded"><span>${s}</span><button onclick="masterSystems=masterSystems.filter(x=>x!=='${s}');saveToLocal();renderSettingsLists();updateDynamicLists()" class="text-red-500"><i class="fas fa-trash"></i></button></div>`).join('');
            document.getElementById('settings-model-list').innerHTML = masterModels.map(m => `<div class="flex justify-between bg-white p-2 mb-1 rounded"><span class="font-mono text-blue-700">${m}</span><button onclick="masterModels=masterModels.filter(x=>x!=='${m}');saveToLocal();renderSettingsLists();updateDynamicLists()" class="text-red-500"><i class="fas fa-trash"></i></button></div>`).join('');
        }
        function addMasterSetting(t) { const i = document.getElementById(t === 'system' ? 'new-master-sys' : 'new-master-model'); const v = i.value.trim(); if (v) { if (t === 'system') masterSystems.push(v); else masterModels.push(v); i.value = ""; saveToLocal(); renderSettingsLists(); updateDynamicLists(); } }

        loadFromLocal(); updateDynamicLists(); renderTable();
    </script>
</body>
</html>